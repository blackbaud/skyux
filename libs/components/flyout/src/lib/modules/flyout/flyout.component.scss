@use 'libs/components/theme/src/lib/styles/variables' as *;
@use 'libs/components/theme/src/lib/styles/compat-tokens-mixins' as compatMixins;

@include compatMixins.sky-default-overrides('.sky-flyout') {
  --sky-override-flyout-background: #fff;
  --sky-override-flyout-border-left: 6px solid
    #{$sky-background-color-primary-dark};
  --sky-override-flyout-header-background: #{$sky-background-color-neutral-light};
  --sky-override-flyout-header-border-bottom: 1px solid
    #{$sky-border-color-neutral-medium};
  --sky-override-flyout-header-button-margin-right: #{$sky-margin-inline-default};
  --sky-override-flyout-header-height: 50px;
  --sky-override-flyout-header-padding: #{$sky-padding-squish-large};
  --sky-override-flyout-header-position: fixed;
  --sky-flyout-resize-handle-offset: -10px;
  --sky-flyout-resize-handle-width: 14px;
}

.sky-flyout {
  position: fixed;
  right: 0;
  top: 0;
  bottom: 0;
  height: 100%;
  transform: translateX(100%);
  transition: transform 250ms ease-in;

  &.sky-flyout-open {
    transform: translateX(0);

    @starting-style {
      transform: translateX(100%);
    }
  }

  background-color: var(
    --sky-override-flyout-background,
    var(--sky-color-background-container-base)
  );
  --sky-background-color-page-default: var(
    --sky-override-flyout-background,
    var(--sky-color-background-container-base)
  );
  --sky-comp-override-list-header-background-color: initial;

  border-left: var(--sky-override-flyout-border-left);

  &:focus {
    outline: none;
  }

  &.sky-flyout-fullscreen {
    min-width: 100%;
    max-width: 100%;

    .sky-flyout-resize-handle {
      cursor: initial;
    }

    .sky-flyout-header {
      width: 100%;
    }
  }

  &.sky-flyout-hidden {
    visibility: hidden;
  }

  .sky-flyout-input-aria-only {
    width: 0;
    height: 0;
    padding: 0;
    opacity: 0;
    position: absolute;
    margin: -1px;
    border: 0;
    overflow: hidden;
    clip: rect(0 0 0 0);
    outline: none;
  }
}

.sky-flyout-resize-handle {
  -webkit-appearance: none;
  -moz-appearance: none;
  height: 100%;
  width: var(
    --sky-flyout-resize-handle-width,
    var(--sky-size-width-resize_handle)
  );
  position: absolute;
  left: var(
    --sky-flyout-resize-handle-offset,
    calc(
      var(
          --sky-flyout-resize-handle-width,
          var(--sky-size-width-resize_handle)
        ) *
        -0.5
    )
  );
  cursor: ew-resize;
  padding: 0;
  border: 0;
  background: transparent;
  display: block;
  top: 0;
  bottom: 0;
  direction: rtl;

  &::-moz-range-thumb,
  &::-moz-range-track {
    -webkit-appearance: none;
    -moz-appearance: none;
    width: 0;
    height: 0;
    border-radius: 0px;
    border: 0 none;
    background: none;
    display: none;
  }

  &::-ms-thumb,
  &::-ms-track {
    -webkit-appearance: none;
    -moz-appearance: none;
    width: 0;
    height: 0;
    border-radius: 0px;
    border: 0 none;
    background: none;
    display: none;
  }

  &::-webkit-slider-thumb {
    -webkit-appearance: none;
    -moz-appearance: none;
    width: 0;
    height: 0;
    border-radius: 0px;
    border: 0 none;
    background: none;
    display: none;
  }
}

.sky-flyout-header {
  border-bottom: var(
    --sky-override-flyout-header-border-bottom,
    var(--sky-border-width-divider) var(--sky-border-style-divider)
      var(--sky-color-border-divider)
  );
  width: inherit;
  background: var(
    --sky-override-flyout-header-background,
    var(--sky-color-background-container-base)
  );
  padding: var(
    --sky-override-flyout-header-padding,
    var(--sky-comp-flyout-header-space-inset-top)
      var(--sky-comp-flyout-header-space-inset-right)
      var(--sky-comp-flyout-header-space-inset-bottom)
      var(--sky-comp-flyout-header-space-inset-left)
  );
  height: var(--sky-override-flyout-header-height);
  display: flex;
  position: var(--sky-override-flyout-header-position, sticky);
  align-items: flex-start;

  .sky-flyout-btn-primary-action,
  .sky-flyout-btn-permalink {
    margin-right: var(
      --sky-override-flyout-header-button-margin-right,
      var(--sky-space-gap-action_group-m)
    );
    display: inline-block;
  }
}

.sky-flyout-header-content {
  flex-grow: 1;
}

.sky-flyout-help-shim {
  padding-right: 8px;

  @media (min-width: $sky-screen-sm-min) {
    padding-right: 50px;
  }
}

.sky-flyout-content {
  overflow-y: auto;
  // This margin-top rule can be removed when default support is dropped;
  margin-top: var(--sky-override-flyout-header-height, 0);
  // account for the header height in the content height by adding the content size (icon buttons) and padding
  height: calc(
    100% - var(
        --sky-override-flyout-header-height,
        calc(
          calc(
              var(--sky-size-icon-m) +
                var(--sky-comp-button-borderless-space-inset-top) +
                var(--sky-comp-button-borderless-space-inset-bottom)
            ) +
            var(--sky-comp-flyout-header-space-inset-top) +
            var(--sky-comp-flyout-header-space-inset-bottom) +
            var(--sky-border-width-divider)
        )
      )
  );
}

.sky-flyout-header-grab-handle {
  cursor: ew-resize;
  cursor: -webkit-grab;
  cursor: -moz-grab;
  margin-right: var(--sky-space-gap-action_group-m);
}
