@use 'libs/components/theme/src/lib/styles/mixins' as mixins;
@use 'libs/components/theme/src/lib/styles/variables' as *;
@use 'libs/components/theme/src/lib/styles/compat-tokens-mixins' as compatMixins;

@include compatMixins.sky-default-overrides('.sky-vertical-tab') {
  --sky-override-vertical-tab-background-color: transparent;
  --sky-override-vertical-tab-background-color-active: #{$sky-background-color-neutral-light};
  --sky-override-vertical-tab-background-color-focus: transparent;
  --sky-override-vertical-tab-background-color-hover: #{$sky-background-color-neutral-light};
  --sky-override-vertical-tab-background-color-selected: #{$sky-background-color-neutral-light};
  --sky-override-vertical-tab-border-left-active: none;
  --sky-override-vertical-tab-border-left-hover: none;
  --sky-override-vertical-tab-border-left-selected: #{$sky-nav-selected-border-width}
    solid #{$sky-highlight-color-info};
  --sky-override-vertical-tab-box-shadow-focus: none;
  --sky-override-vertical-tab-count-margin-left: #{$sky-margin-half};
  --sky-override-vertical-tab-font-color: #{$sky-text-color-default};
  --sky-override-vertical-tab-font-color-disabled: var(
    --sky-text-color-deemphasized
  );
  --sky-override-vertical-tab-font-selected-color: #{$sky-text-color-default};
  --sky-override-vertical-tab-gap: #{$sky-margin-half};
  --sky-override-vertical-tab-heading-error-padding-left: #{$sky-padding-half};
  --sky-override-vertical-tab-hover-font-color: #{$sky-text-color-default};
  --sky-override-vertical-tab-margin: #{$sky-margin-half} 0 #{$sky-margin-half}
    #{$sky-margin};
  --sky-override-vertical-tab-outline-focus: auto;
  --sky-override-vertical-tab-padding: #{$sky-padding-3_4} 0 #{$sky-padding-3_4}
    #{$sky-padding};
  --sky-override-vertical-tab-padding-left-active: #{$sky-padding};
  --sky-override-vertical-tab-padding-left-selected: 6px;
  --sky-override-vertical-tab-padding-left-hover: #{$sky-padding};
}

@include compatMixins.sky-modern-overrides('.sky-vertical-tab') {
  --sky-override-vertical-tab-background-color-disabled: transparent;
  --sky-override-vertical-tab-background-color-selected: transparent;
  --sky-override-vertical-tab-border-left-active: 4px solid
    var(--modern-color-blue-50);
  --sky-override-vertical-tab-border-left-hover: 1px solid
    var(--modern-color-blue-50);
  --sky-override-vertical-tab-gap: #{$sky-theme-modern-margin-inline-md};
  --sky-override-vertical-tab-heading-error-padding-left: #{$sky-padding-half};
  --sky-override-vertical-tab-margin: #{$sky-theme-modern-margin-inline-md} 0 #{$sky-theme-modern-margin-inline-md}
    #{$sky-theme-modern-margin-inline-sm};
  --sky-override-vertical-tab-content-pane-margin-bottom: 0;
}

:host {
  &:has(~ sky-vertical-tab) .sky-vertical-tab {
    margin-bottom: var(
      --sky-override-vertical-tab-gap,
      var(--sky-space-gap-action_group-l)
    );
  }

  &:has(.sky-vertical-tabset-button-disabled) {
    cursor: not-allowed;
  }
}

.sky-vertical-tab {
  cursor: pointer;
  background-color: var(
    --sky-override-vertical-tab-background-color,
    var(--sky-color-background-nav-base)
  );
  padding: var(
    --sky-override-vertical-tab-padding,
    var(--sky-space-inset-pillarbox-2_3-top-m)
      var(--sky-space-inset-pillarbox-2_3-right-m)
      var(--sky-space-inset-pillarbox-2_3-bottom-m)
      var(--sky-space-inset-pillarbox-2_3-left-m)
  );
  margin: var(
    --sky-override-vertical-tab-margin,
    0 0 0 var(--sky-space-inline-s)
  );
  display: flex;
  text-decoration: none;
  color: var(
    --sky-override-vertical-tab-font-color,
    var(--sky-color-text-deemphasized)
  );
  border-radius: var(--sky-border-radius-0);

  &:hover {
    color: var(
      --sky-override-vertical-tab-hover-font-color,
      var(--sky-color-text-default)
    );
    background-color: var(
      --sky-override-vertical-tab-background-color-hover,
      var(--sky-color-background-nav-hover)
    );

    // TODO: Tokenize with sectioned form
    .sky-vertical-tab-right-arrow {
      color: darken($sky-text-color-icon-borderless, 20%);
    }
  }

  &:active {
    background-color: var(
      --sky-override-vertical-tab-background-color-active,
      var(--sky-color-background-nav-active)
    );
    border-left: var(
      --sky-override-vertical-tab-border-left-active,
      var(--sky-border-width-selected-l) solid var(--sky-color-border-selected)
    );
    color: var(
      --sky-override-vertical-tab-active-font-color,
      var(--sky-color-text-default)
    );
    padding-left: var(
      --sky-override-vertical-tab-padding-left-active,
      calc(
        var(--sky-space-inset-pillarbox-2_3-left-m) - var(
            --sky-border-width-selected-l
          )
      )
    );
  }

  &:not(:active):focus-visible {
    background-color: var(
      --sky-override-vertical-tab-background-color-focus,
      var(--sky-color-background-nav-focus)
    );
    outline: var(
      --sky-override-vertical-tab-outline-focus,
      var(--sky-border-width-selected-m) solid var(--sky-color-border-selected)
    );
    outline-offset: var(
      --sky-override-vertical-tab-outline-focus-offset,
      calc(var(--sky-border-width-selected-m) * -1)
    );
    box-shadow: var(
      --sky-override-vertical-tab-box-shadow-focus,
      var(--sky-elevation-focus)
    );
  }

  &:not(.sky-vertical-tab-active):not(:active):hover {
    padding-left: var(
      --sky-override-vertical-tab-padding-left-hover,
      calc(
        var(--sky-space-inset-pillarbox-2_3-left-m) - var(
            --sky-border-width-selected-s
          )
      )
    );
    border-left: var(
      --sky-override-vertical-tab-border-left-hover,
      var(--sky-border-width-selected-s) solid var(--sky-color-border-selected)
    );
  }
}

.sky-vertical-tab-active {
  background-color: var(
    --sky-override-vertical-tab-background-color-selected,
    var(--sky-color-background-selected-soft)
  );
  color: var(
    --sky-override-vertical-tab-selected-font-color,
    var(--sky-color-text-default)
  );
  padding-left: var(
    --sky-override-vertical-tab-padding-left-selected,
    calc(
      var(--sky-space-inset-pillarbox-2_3-left-m) - var(
          --sky-border-width-selected-l
        )
    )
  );
  border-left: var(
    --sky-override-vertical-tab-border-left-selected,
    var(--sky-border-width-selected-l) solid var(--sky-color-border-selected)
  );
}

.sky-vertical-tab-hidden {
  display: none;
}

.sky-vertical-tab-display {
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
}

.sky-vertical-tab-heading-error {
  padding-left: var(
    --sky-override-vertical-tab-heading-error-padding-left,
    var(--sky-space-gap-text_action-s)
  );
}

.sky-vertical-tab-count {
  margin-left: var(
    --sky-override-vertical-tab-count-margin-left,
    var(--sky-space-gap-label-s)
  );
}

.sky-vertical-tabset-button-disabled {
  background-color: var(
    --sky-override-vertical-tab-background-color-disabled,
    var(--sky-color-background-nav-disabled)
  );
  // Only needed for default theme. This rule can be removed when that theme is removed.
  color: var(
    --sky-override-vertical-tab-font-color-disabled,
    var(--sky-color-text-deemphasized)
  );
  pointer-events: none;
}

// TODO: Tokenize with sectioned form
.sky-vertical-tab-right-arrow {
  padding: 3px $sky-padding 0 0;
  color: $sky-text-color-icon-borderless;
}

.sky-vertical-tab-content-pane {
  // NOTE: The overrides here are housed in the tabset component scss file due to view encapsulation issues and where this class ends up rendered.
  margin-bottom: var(
    --sky-override-vertical-tab-content-pane-margin-bottom,
    var(--sky-space-stacked-s)
  );

  &:focus-visible {
    outline: none;
    border: none;
  }
}

@include mixins.sky-theme-modern {
  .sky-vertical-tab {
    // TODO: This is due to a bug in icons where icon stacks display larger than their inner icons current.
    .sky-vertical-tab-heading-error {
      position: relative;
      top: -2px;
    }
  }
}

:host-context(.sky-sectioned-form-tabs-only) {
  .sky-vertical-tab {
    margin-left: 0;
  }
}
